<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Google's FooBar Challenge</title>
    <link rel="stylesheet" href="/styles/blog/google-foobar-challenge.css" />
    <link rel="stylesheet" href="/styles/nav.css" />
    <link rel="icon" href="/images/logo.svg" />
    <!-- google font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap"
      rel="stylesheet"
    />

    <!-- https://ogp.me/#types -->
    <meta property="og:title" content="Google's FooBar Challenge" />
    <meta property="og:type" content="article" />
    <meta
      property="og:image"
      content="https://www.lachlangibson.dev/images/blog/foobar-challenge.png"
    />
    <meta
      property="og:url"
      content="https://www.lachlangibson.dev/blog/google-foobar-challenge"
    />
    <meta
      property="og:description"
      content="I completed Google's FooBar challenge which involved solving a series of mathematical and coding problems. The challenge included 5 levels of increasing difficulty which I solve in this document."
    />
    <meta property="og:image:width" content="512" />
    <meta property="og:image:height" content="512" />
    <meta property="article:author" content="https://www.lachlangibson.dev/" />
    <meta
      property="article:publisher"
      content="https://www.lachlangibson.dev/"
    />
    <meta property="article:published_time" content="2023-05-24" />
    <meta property="article:modified_time" content="2023-05-24" />
    <meta property="article:tag" content="Google" />
    <meta property="article:tag" content="Foobar" />
    <meta property="article:tag" content="Coding Challenge" />
    <meta property="article:tag" content="Python" />
    <meta property="article:tag" content="Java" />
    <meta property="article:tag" content="Mathematics" />
    <meta property="article:tag" content="Prime numbers" />
    <meta property="article:tag" content="Dynamic programming" />
    <meta property="article:tag" content="Memoisation" />
    <meta property="article:tag" content="Recursion" />
    <meta property="article:tag" content="Beatty sequence" />
    <meta property="article:tag" content="A*" />
    <meta property="article:tag" content="Algorithm" />

    <!-- MathJax for latex maths -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
  </head>

  <body>
    <header>
      <nav>
        <div>
          <img id="navbar-icon" src="/images/logo.svg" alt="Lachlan Gibson" />
          <span id="lachlan-nav-text">Lachlan Gibson</span>
        </div>
        <a href="/">Home</a>
        <a href="/about">About</a>
        <a class="current-page" href="/blog">Blog</a>
        <div class="icon-container">
          <a
            href="https://www.linkedin.com/in/lachlan-james-gibson/"
            class="icon-link"
            target="_blank"
            ><img src="/images/linkedin_icon.svg" alt="LinkedIn"
          /></a>
          <a
            href="https://github.com/LachlanGibson"
            class="icon-link"
            target="_blank"
            ><img src="/images/github_icon.svg" alt="GitHub" id="github-icon"
          /></a>
          <a
            href="https://scholar.google.com/citations?user=NeEMSU0AAAAJ&hl=en"
            target="_blank"
          >
            <img src="/images/googlescholar_icon.svg" alt="Google Scholar" />
          </a>
        </div>
      </nav>
    </header>
    <main>
      <article>
        <h1>Google's FooBar Challenge</h1>
        <span
          style="
            font-style: italic;
            font-size: 1rem;
            font-weight: lighter;
            margin: 0;
          "
          >This article is a work in progress. Last updated 24/05/2023.</span
        >
        <p>
          Recently I completed Google's
          <a href="https://foobar.withgoogle.com/" target="_blank">FooBar</a>
          challenge during April 2023. This involved solving a series of
          mathematical and coding problems using Python 2.7 (or Java). The
          challenge included 5 levels of increasing difficulty with 1-3 tasks
          per level. I summarise in this document the tasks I received and
          explain how I solved each one. See the articles by
          <a
            href="https://www.turing.com/kb/foobar-google-secret-hiring-technique"
            target="_blank"
            >Turing</a
          >
          and
          <a
            href="https://itsmohitt.medium.com/things-you-should-know-about-google-foobar-invitation-703a535bf30f"
            target="_blank"
            >Medium</a
          >
          to learn more about the challenge.<br />
          <br />
          The document is structured into five sections, one for each challenge,
          and each challenge contains a section for each task. In each task
          section, there are three main parts. The first is a simplified task
          description adapted from the original text which can be found in a
          black box. The second is an explanation of my own solution to the
          problem. And the third is my own Python code which can be revealed by
          clicking on on the relevant box. The constraints for coding in Python
          or Java are included below.<br />
          <br />
          If you wish to attempt a task yourself, I recommend you firstly read
          the task description, then think through the problem and write your
          own code. Feel free to search online regarding any relevant
          mathematical or coding principles, but do not search for a direct
          solution to the problem. If you find yourself stuck for a long time,
          then read my own solution explanation, but do not yet reveal my code.
          I recommend you only reveal and look through my code if you are
          absolutely stuck, or wish to compare your solution with mine.
          Remember, some of the challenges are difficult, and can take several
          hours or even several days to solve. Have fun!
        </p>

        <div class="table-of-contents toc-layer1">
          <a href="#sec-challenge1" id="a-challenge1">Challenge 1</a>
          <a href="#sec-challenge2" id="a-challenge2">Challenge 2</a>
          <a href="#sec-challenge3" id="a-challenge3">Challenge 3</a>
          <a href="#sec-challenge4" id="a-challenge4">Challenge 4</a>
          <a href="#sec-challenge5" id="a-challenge5">Challenge 5</a>
          <a href="#sec-bonus" id="a-bonus">Bonus</a>
        </div>

        <div class="foobar-task-description">
          Python Constraints<br />
          ==================<br />
          Your code will run inside a Python 2.7.13 sandbox. All tests will be
          run by calling the solution() function. Standard libraries are
          supported except for bz2, crypt, fcntl, mmap, pwd, pyexpat, select,
          signal, termios, thread, time, unicodedata, zipimport, zlib.
          Input/output operations are not allowed. Your solution must be under
          32000 characters in length including new lines and other non-printing
          characters.<br />
          <br />
          Java Constraints<br />
          ================<br />
          Your code will be compiled using standard Java 8. All tests will be
          run by calling the solution() method inside the Solution class.
          Execution time is limited. Wildcard imports and some specific classes
          are restricted (e.g. java.lang.ClassLoader). You will receive an error
          when you verify your solution if you have used a restricted class.
          Third-party libraries, input/output operations, spawning threads or
          processes and changes to the execution environment are not allowed.
          Your solution must be under 32000 characters in length including new
          lines and other non-printing characters.
        </div>

        <section class="foobar-challenge" id="sec-challenge1">
          <h2>Challenge 1</h2>
          <!-- <div class="table-of-contents toc-layer2">
            <a href="#sec-task-1">Re-ID</a>
          </div> -->
          <p>
            The first level contained only a single task, titled
            <a href="#sec-task-1">Re-ID</a>, which involved efficiently
            generating prime numbers. A task summary, adapted from the original
            challenge instructions, is given below.
          </p>
          <section class="foobar-task" id="sec-task-1">
            <div class="foobar-task-description">
              Re-ID<br />
              =====<br />
              <br />
              Write a function solution(n) which takes in the starting index n
              of a string of all primes, "2357111317192329...", and returns the
              next five digits in the string. For example, if n is 3 then their
              ID number will be "71113". The value of n will always be between 0
              and 10000.<br />
              <br />
              -- Test cases --<br />
              Input : solution(0)<br />
              Output: 23571<br />
              <br />
              Input : solution(3)<br />
              Output: 71113
            </div>

            <p>
              If the string of prime numbers is known, then the solution is
              trivially given by returning the five digits starting at index
              \(n\). Therefore, I solved this problem by defining a function
              that firstly generated this string of primes. This function works
              by checking the primality of all integers from \(2\) to
              \(m=20+\lfloor n \ln 10 \rfloor \). This choice of \(m\) ensures
              that the resulting string of primes is at least \(n+5\) characters
              long, without too much excessive computation.<br />
              <br />
              This is a result of the
              <a
                href="https://mathworld.wolfram.com/PrimeNumberTheorem.html"
                target="_blank"
                >prime number theorem</a
              >
              which gives an asymptotic expression for the prime counting
              function, \[\pi(m)\sim{m\over \ln m},\] which counts the number of
              prime numbers \(\leqslant m\). The maximum number of digits each
              prime can have is \(\lceil \log m \rceil\) (base 10). Therefore,
              having \(n+5 &lt; \pi(m)\lceil \log m \rceil\) should ensure the
              resulting string is long enough when \(n\) is large. This
              condition is satisfied by \[m=20+\lfloor n \ln 10 \rfloor ,\]
              which I checked empirically worked for when \(n\) is low.<br />
              <br />
              Each integer is considered prime if no previously identified prime
              numbers divide it. This involves checking all previously
              identified prime numbers less than or equal to the square-root of
              the current candidate number (there is no point checking factors
              higher than the square-root because they all pair with divisors
              less than the square-root). Once the list of prime numbers is
              generated then the integers are converted to strings before being
              joined into a single string.
            </p>
            <!--http://tohtml.com/python/-->
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> generate_prime_string<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; ">"""</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Returns a string of consecutive prime numbers with a target</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        length of at least n + 5.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        """</span></span>
<span class="line_wrapper">        prime_list <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># prime density * log(n) approximates the length of the string</span></span>
<span class="line_wrapper">        max_num <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">20</span> <span style="color:#00dddd; ">+</span> <span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">(</span><span style="color:#009f00; ">2.303</span><span style="color:#00dddd; ">*</span>n<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> num_check <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">,</span> max_num <span style="color:#00dddd; ">+</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            prime <span style="color:#d2cd86; ">=</span> True</span>
<span class="line_wrapper">            <span style="color:#9999a9; "># no need to check larger factors</span></span>
<span class="line_wrapper">            max_factor <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">(</span>num_check<span style="color:#00dddd; ">**</span><span style="color:#009f00; ">0.5</span> <span style="color:#00dddd; ">+</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">for</span> p <span style="color:#e66170; font-weight:bold; ">in</span> prime_list<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">if</span> num_check <span style="color:#00dddd; ">%</span> p <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    prime <span style="color:#d2cd86; ">=</span> False</span>
<span class="line_wrapper">                    <span style="color:#e66170; font-weight:bold; ">break</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">elif</span> p <span style="color:#00dddd; ">&gt;</span> max_factor<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    <span style="color:#e66170; font-weight:bold; ">break</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> prime<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                prime_list<span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>num_check<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#00c4c4; ">""</span><span style="color:#d2cd86; ">.</span>join<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">[</span><span style="color:#e66170; font-weight:bold; ">str</span><span style="color:#d2cd86; ">(</span>p<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> p <span style="color:#e66170; font-weight:bold; ">in</span> prime_list<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> generate_prime_string<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">[</span>n<span style="color:#d2cd86; ">:</span>n<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">5</span><span style="color:#d2cd86; ">]</span></span></pre>
          </section>
        </section>
        <section class="foobar-challenge" id="sec-challenge2">
          <h2>Challenge 2</h2>
          <!-- <div class="table-of-contents toc-layer2">
            <a href="#sec-task-2">Please Pass the Coded Messages</a>
            <a href="#sec-task-3">Bunny Worker Locations</a>
          </div> -->
          <p>
            The second level contained two tasks, titled
            <a href="#sec-task-2">Please Pass the Coded Messages</a> and
            <a href="#sec-task-3">Bunny Worker Locations</a>.
          </p>
          <section class="foobar-task" id="sec-task-2">
            <div class="foobar-task-description">
              Please Pass the Coded Messages<br />
              ==============================<br />
              <br />
              You have L, a list containing some digits (0 to 9). Write a
              function solution(L) which finds the largest number that can be
              made from some or all of these digits and is divisible by 3. If it
              is not possible to make such a number, return 0 as the solution. L
              will contain anywhere from 1 to 9 digits. The same digit may
              appear multiple times in the list, but each element in the list
              may only be used once.<br />
              <br />
              -- Test cases -- <br />
              Input : solution([3, 1, 4, 1])<br />
              Output: 4311<br />
              <br />
              Input : solution([3, 1, 4, 1, 5, 9])<br />
              Output: 94311<br />
            </div>

            <p>
              To solve this problem, let's first consider the simpler problem of
              finding the largest number containing all the digits in the list
              L. Obviously, this is achieved by sorting the list with the
              largest on the left to the smallest on the right, so that the
              larger digits correspond to the higher decimal positions. Removing
              any digit will strictly decrease the size of the number (except
              when all digits are zero). Therefore, this result forms an upper
              bound to the original problem of finding the largest number that
              is also divisible by three.<br />
              <br />
              Now we can make use of the property of decimal numbers that they
              are divisible by 3 if and only if the sum of their digits is also
              divisible by three. Or, more generally, that the number is
              congruent modulo 3 to its digit sum. Since the order of a
              summation does not effect the result, we can use this rule to
              check the modularity of a list of numbers without knowing the
              order. Next we note that removing any two digits never lowers the
              value by less than only removing any one digit. Also note that
              removing a larger digit will lower the value by more than removing
              a lower digit. Therefore, we can solve the problem by firstly
              minimising the number of digits that need to be removed, and then
              minimising the values of the removed digits.<br />
              <br />
              The sum of digits can be congruent to 0, 1 or 2 (mod 3). In the
              first case, any permutation of all digits is divisible by 3
              without removing any digits. Therefore, the solution returns the
              number containing all the digits in descending order. If the sum
              is congruent to 1 or 2, then there are three cases. Firstly, one
              of the digits is congruent to the sum, in which case, we just
              remove the smallest such digit. Secondly, two of the digits are
              congruent to twice the sum, in which case we remove the two
              smallest such digits. Thirdly, no combination of digits is
              divisible by 3, so return 0. After removing any digits, the
              solution is the number containing all the remaining digits in
              descending order. Note, that if there are no remaining digits,
              then return 0.
            </p>

            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>L<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    L <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">sorted</span><span style="color:#d2cd86; ">(</span>L<span style="color:#d2cd86; ">,</span> reverse<span style="color:#d2cd86; ">=</span>True<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    remainder <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">sum</span><span style="color:#d2cd86; ">(</span>L<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">%</span> <span style="color:#00a800; ">3</span></span>
<span class="line_wrapper"></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">if</span> remainder <span style="color:#00dddd; ">!=</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># split L into three lists based on remainder</span></span>
<span class="line_wrapper">        L0 <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span>l <span style="color:#e66170; font-weight:bold; ">for</span> l <span style="color:#e66170; font-weight:bold; ">in</span> L <span style="color:#e66170; font-weight:bold; ">if</span> l<span style="color:#00dddd; ">%</span><span style="color:#00a800; ">3</span><span style="color:#00dddd; ">==</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        L1 <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span>l <span style="color:#e66170; font-weight:bold; ">for</span> l <span style="color:#e66170; font-weight:bold; ">in</span> L <span style="color:#e66170; font-weight:bold; ">if</span> l<span style="color:#00dddd; ">%</span><span style="color:#00a800; ">3</span><span style="color:#00dddd; ">==</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        L2 <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span>l <span style="color:#e66170; font-weight:bold; ">for</span> l <span style="color:#e66170; font-weight:bold; ">in</span> L <span style="color:#e66170; font-weight:bold; ">if</span> l<span style="color:#00dddd; ">%</span><span style="color:#00a800; ">3</span><span style="color:#00dddd; ">==</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper"></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> remainder <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>L1<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">&gt;=</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                L1<span style="color:#d2cd86; ">.</span>pop<span style="color:#d2cd86; ">(</span><span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">elif</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>L2<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">&gt;=</span> <span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                L2<span style="color:#d2cd86; ">.</span>pop<span style="color:#d2cd86; ">(</span><span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                L2<span style="color:#d2cd86; ">.</span>pop<span style="color:#d2cd86; ">(</span><span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">else</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">elif</span> remainder <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>L2<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">&gt;=</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                L2<span style="color:#d2cd86; ">.</span>pop<span style="color:#d2cd86; ">(</span><span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">elif</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>L1<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">&gt;=</span> <span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                L1<span style="color:#d2cd86; ">.</span>pop<span style="color:#d2cd86; ">(</span><span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                L1<span style="color:#d2cd86; ">.</span>pop<span style="color:#d2cd86; ">(</span><span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">else</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">        L <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">sorted</span><span style="color:#d2cd86; ">(</span>L0 <span style="color:#00dddd; ">+</span> L1 <span style="color:#00dddd; ">+</span> L2<span style="color:#d2cd86; ">,</span> reverse<span style="color:#d2cd86; ">=</span>True<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>L<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">""</span><span style="color:#d2cd86; ">.</span>join<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">str</span><span style="color:#d2cd86; ">(</span>i<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> i <span style="color:#e66170; font-weight:bold; ">in</span> L<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span></pre>
          </section>
          <section class="foobar-task" id="sec-task-3">
            <div class="foobar-task-description">
              Bunny Worker Locations<br />
              ======================<br />

              <br />
              In a triangular grid of values each cell can be represented as
              points (x, y), with x being the distance from the vertical wall,
              and y being the height from the ground. For example, the value at
              (1, 1) is 1, the value at (3, 2) is 9, and the value at (2,3) is
              8. This pattern of numbering continues indefinitely.<br />
              <br />
              | 7<br />
              | 4 8<br />
              | 2 5 9<br />
              | 1 3 6 10<br />
              <br />
              Write a function solution(x, y) which returns the grid value at
              the location (x, y). Both x and y will be at least 1 and no
              greater than 100,000. Since the values can be very large, return
              your solution as a string representation of the number.<br />
              <br />
              -- Test cases --<br />
              Input : solution(5, 10)<br />
              Output: 96<br />
              <br />
              Input : solution(3, 2)<br />
              Output: 9
            </div>

            <p>
              The grid changes by 1 each step along a diagonal, which gives the
              following recursive relationships \[f(x,y)=f(x+1,y-1)-1,\]
              \[f(x,y)=f(x+k,y-k)-k,\] where \(k\) can be any integer satisfying
              \(0 &lt; k &lt; y\). The grid coordinates can be as large as
              100000 so generating the entire grid would probably be much slower
              than directly calculating the values from a closed form expression
              for \(f(x,y)\). To find one, I first noticed that the first row is
              given by the
              <a
                href="https://en.wikipedia.org/wiki/Triangular_number"
                target="_blank"
                >triangular numbers</a
              >. This makes sense since the values are given by the size of each
              diagonal, which grow by 1 each time. Therefore,
              \[f(x,1)=\sum_{k=1}^xk={x(x+1)\over 2}.\] So, we can get a closed
              form expression by choosing \(k=y-1\) in the recursive
              relationship and then using the result for \(f(x,1)\) by
              substituting \(x\rightarrow x+y-1\) \[f(x,y)={(x+y-1)(x+y)\over
              2}-y+1.\]
            </p>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>x<span style="color:#d2cd86; ">,</span> y<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">str</span><span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">+</span>y<span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">*</span><span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">+</span>y<span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">//</span><span style="color:#00a800; ">2</span><span style="color:#00dddd; ">-</span>y<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span></pre>
          </section>
        </section>
        <section class="foobar-challenge" id="sec-challenge3">
          <h2>Challenge 3</h2>
          <!-- <div class="table-of-contents toc-layer2">
            <a href="#sec-task-4">Prepare the Bunnies' Escape</a>
            <a href="#sec-task-5">The Grandest Staircase Of Them All</a>
            <a href="#sec-task-6">Fuel Injection Perfection</a>
          </div> -->
          <p>
            The third level contained three tasks, titled
            <a href="#sec-task-4">Prepare the Bunnies' Escape</a>,
            <a href="#sec-task-5">The Grandest Staircase Of Them All</a> and
            <a href="#sec-task-6">Fuel Injection Perfection</a>.
          </p>
          <section class="foobar-task" id="sec-task-4">
            <div class="foobar-task-description">
              Prepare the Bunnies' Escape<br />
              ===========================<br />
              <br />
              Write a function solution(map) that generates the length of the
              shortest path along a rectangular grid from (0,0) to (w-1,h-1),
              where w is the grid width, h is the grid height and the map is
              represented as a matrix of 0s and 1s, where 0s are passable space
              and 1s are impassable walls. The path may remove up to one wall.
              The path length is the total number of nodes you pass through,
              counting both the entrance and exit nodes. The starting and ending
              positions are always passable (0). The map will always be
              solvable, though you may or may not need to remove a wall. The
              height and width of the map can be from 2 to 20. Moves can only be
              made in cardinal directions; no diagonal moves are allowed.<br />
              <br />
              -- Test cases --<br />
              Input : solution([[0, 1, 1, 0], [0, 0, 0, 1], [1, 1, 0, 0], [1, 1,
              1, 0]])<br />
              Output: 7<br />
              <br />
              Input : solution([[0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 0], [0, 0,
              0, 0, 0, 0], [0, 1, 1, 1, 1, 1], [0, 1, 1, 1, 1, 1], [0, 0, 0, 0,
              0, 0]])<br />
              Output: 11
            </div>
            <p>
              To solve this problem I represent maps as
              <a
                href="https://en.wikipedia.org/wiki/Graph_theory"
                target="_blank"
                >graphs</a
              >
              where nodes correspond to passable spaces and edges correspond to
              adjacent passable spaces. Then I use the
              <a
                href="https://en.wikipedia.org/wiki/A*_search_algorithm"
                target="_blank"
                >A* algorithm</a
              >
              to find the shortest path length from the start and end nodes. To
              improve the efficiency of the algorithm I use the
              <a
                href="https://simple.wikipedia.org/wiki/Manhattan_distance"
                target="_blank"
                >Manhattan distance</a
              >
              as a lower bound to the remaining distance between any node and
              the end node. After implementing the A* algorithm I use it to find
              the shortest path lengths of all possible maps with exactly 1 or 0
              walls removed. The function then returns the smallest of these
              path lengths.
            </p>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> a_star<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">def</span> manhattan_dist<span style="color:#d2cd86; ">(</span>a<span style="color:#d2cd86; ">,</span> b<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">sum</span><span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">[</span><span style="color:#e66170; font-weight:bold; ">abs</span><span style="color:#d2cd86; ">(</span>i<span style="color:#00dddd; ">-</span>j<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> i<span style="color:#d2cd86; ">,</span> j <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">zip</span><span style="color:#d2cd86; ">(</span>a<span style="color:#d2cd86; ">,</span>b<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">def</span> passable<span style="color:#d2cd86; ">(</span>p<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            x<span style="color:#d2cd86; ">,</span> y <span style="color:#d2cd86; ">=</span> p</span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">return</span> x<span style="color:#00dddd; ">&gt;=</span><span style="color:#00a800; ">0</span> <span style="color:#e66170; font-weight:bold; ">and</span> x<span style="color:#00dddd; ">&lt;</span>w <span style="color:#e66170; font-weight:bold; ">and</span> y<span style="color:#00dddd; ">&gt;=</span><span style="color:#00a800; ">0</span> <span style="color:#e66170; font-weight:bold; ">and</span> y<span style="color:#00dddd; ">&lt;</span>h <span style="color:#e66170; font-weight:bold; ">and</span> <span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">[</span>y<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">[</span>x<span style="color:#d2cd86; ">]</span> <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Generate graph</span></span>
<span class="line_wrapper">        edges <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">dict</span><span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> x <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>w<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">for</span> y <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>h<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                edges<span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">(</span>x<span style="color:#d2cd86; ">,</span>y<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">for</span> c <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span>y<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span><span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span>y<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span><span style="color:#d2cd86; ">(</span>x<span style="color:#d2cd86; ">,</span>y<span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span><span style="color:#d2cd86; ">(</span>x<span style="color:#d2cd86; ">,</span>y<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    <span style="color:#e66170; font-weight:bold; ">if</span> passable<span style="color:#d2cd86; ">(</span>c<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                        edges<span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">(</span>x<span style="color:#d2cd86; ">,</span>y<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>c<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Initialise algorithm</span></span>
<span class="line_wrapper">        start<span style="color:#d2cd86; ">,</span> finish <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">(</span>w<span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span>h<span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> <span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">,</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        v_open<span style="color:#d2cd86; ">,</span> v_closed <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">set</span><span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">[</span>start<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> <span style="color:#e66170; font-weight:bold; ">set</span><span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        dist_t<span style="color:#d2cd86; ">,</span> dist_h <span style="color:#d2cd86; ">=</span> <span style="color:#b060b0; ">{</span>start <span style="color:#d2cd86; ">:</span> <span style="color:#00a800; ">0</span><span style="color:#b060b0; ">}</span><span style="color:#d2cd86; ">,</span> <span style="color:#b060b0; ">{</span>start <span style="color:#d2cd86; ">:</span> manhattan_dist<span style="color:#d2cd86; ">(</span>start<span style="color:#d2cd86; ">,</span>finish<span style="color:#d2cd86; ">)</span><span style="color:#b060b0; ">}</span></span>
<span class="line_wrapper">        continue_loop <span style="color:#d2cd86; ">=</span> True</span>
<span class="line_wrapper">        c <span style="color:#d2cd86; ">=</span> start</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">while</span> continue_loop<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">for</span> adj <span style="color:#e66170; font-weight:bold; ">in</span> edges<span style="color:#d2cd86; ">[</span>c<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                t <span style="color:#d2cd86; ">=</span> dist_t<span style="color:#d2cd86; ">[</span>c<span style="color:#d2cd86; ">]</span> <span style="color:#00dddd; ">+</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">if</span> adj <span style="color:#e66170; font-weight:bold; ">in</span> v_open<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    <span style="color:#e66170; font-weight:bold; ">if</span> t <span style="color:#00dddd; ">&lt;</span> dist_t<span style="color:#d2cd86; ">[</span>adj<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                        dist_t<span style="color:#d2cd86; ">[</span>adj<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> t</span>
<span class="line_wrapper">                        dist_h<span style="color:#d2cd86; ">[</span>adj<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> t <span style="color:#00dddd; ">+</span> manhattan_dist<span style="color:#d2cd86; ">(</span>adj<span style="color:#d2cd86; ">,</span>finish<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">elif</span> adj <span style="color:#e66170; font-weight:bold; ">not</span> <span style="color:#e66170; font-weight:bold; ">in</span> v_closed<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    v_open<span style="color:#d2cd86; ">.</span>add<span style="color:#d2cd86; ">(</span>adj<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                    dist_t<span style="color:#d2cd86; ">[</span>adj<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> t</span>
<span class="line_wrapper">                    dist_h<span style="color:#d2cd86; ">[</span>adj<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> t <span style="color:#00dddd; ">+</span> manhattan_dist<span style="color:#d2cd86; ">(</span>adj<span style="color:#d2cd86; ">,</span>finish<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            v_closed<span style="color:#d2cd86; ">.</span>add<span style="color:#d2cd86; ">(</span>c<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            v_open<span style="color:#d2cd86; ">.</span>remove<span style="color:#d2cd86; ">(</span>c<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            </span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>v_open<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">&lt;</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                continue_loop <span style="color:#d2cd86; ">=</span> False</span>
<span class="line_wrapper">                distance <span style="color:#d2cd86; ">=</span> <span style="color:#00dddd; ">-</span><span style="color:#00a800; ">2</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">else</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                c <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">min</span><span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">(</span>dist_h<span style="color:#d2cd86; ">[</span>v<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> v<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> v <span style="color:#e66170; font-weight:bold; ">in</span> v_open<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">if</span> c <span style="color:#00dddd; ">==</span> finish<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    continue_loop <span style="color:#d2cd86; ">=</span> False</span>
<span class="line_wrapper">                    distance <span style="color:#d2cd86; ">=</span> dist_t<span style="color:#d2cd86; ">[</span>finish<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> distance <span style="color:#00dddd; ">+</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Run A* on all possible maps</span></span>
<span class="line_wrapper">    h<span style="color:#d2cd86; ">,</span> w <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    dist_list <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span>a_star<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> x <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>w<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> y <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>h<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> <span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">[</span>y<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">[</span>x<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">[</span>y<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">[</span>x<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">                dist_list<span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>a_star<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">[</span>y<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">[</span>x<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">min</span><span style="color:#d2cd86; ">(</span>d <span style="color:#e66170; font-weight:bold; ">for</span> d <span style="color:#e66170; font-weight:bold; ">in</span> dist_list <span style="color:#e66170; font-weight:bold; ">if</span> d <span style="color:#00dddd; ">&gt;=</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">)</span></span></pre>
          </section>
          <section class="foobar-task" id="sec-task-5">
            <div class="foobar-task-description">
              The Grandest Staircase Of Them All<br />
              ==================================<br />
              <br />
              Write a function called solution(n) that takes a positive integer
              n and returns the number of different staircases that can be built
              from exactly n bricks. n will always be between 3 and 200
              (inclusive). Each type of staircase should consist of 2 or more
              steps with no two steps being at the same height. All steps must
              contain at least one brick. A step's height is classified as the
              total amount of bricks that make up that step.<br />
              <br />
              For example, when n = 3, you have only 1 choice of how to build
              the staircase, with the first step having a height of 2 and the
              second step having a height of 1: (# indicates a brick)<br />
              <br />
              #<br />
              ##<br />
              21<br />
              <br />
              When n = 4, you still only have 1 staircase choice:<br />
              <br />
              #<br />
              #<br />
              ##<br />
              31<br />
              <br />
              But when n = 5, there are two ways you can build a staircase from
              the given bricks. The two staircases can have heights (4, 1) or
              (3, 2), as shown below:<br />
              <br />
              #<br />
              #<br />
              #<br />
              ##<br />
              41<br />
              <br />
              #<br />
              ##<br />
              ##<br />
              32<br />
              <br />
              -- Test cases --<br />
              Input : solution(200)<br />
              Output: 487067745<br />
              <br />
              Input : solution(3)<br />
              Output: 1
            </div>
            <p>
              To solve this problem I used the principles of
              <a
                href="https://en.wikipedia.org/wiki/Dynamic_programming"
                target="_blank"
                >dynamic programming</a
              >
              to write a recursive function which relied on
              <a
                href="https://en.wikipedia.org/wiki/Memoization"
                target="_blank"
                >memoisation</a
              >
              to run efficiently. Consider the function \(w(n,m,s)\) which
              calculates the number of valid staircases that can be built with
              \(n\) bricks, with each stair containing a maximum of \(m\) bricks
              and at least \(s\) more steps. We can express \(w\) as a recursive
              function. Specifically, the number of staircases that can be built
              is the sum of the number of staircases that can be built given the
              size of the next step. For example, if there are 5 bricks, then
              the number of possible staircases is the number of staircases that
              end with a height of 1, plus the number that end with a height of
              2, plus a height of 3 and plus a height of 4.<br />
              <br />
              There are two base cases to this recursion. The first occurs when
              there are too many bricks. This occurs when the number of bricks
              is more than a maximal staircase with a constant step size of 1,
              \(n &gt; m(m+1)/2\). In this case, the number of valid staircases
              is 0. The second base case occurs when there are no bricks
              (\(n=0\)), and the minimum number of additional steps is less than
              zero (\(s\leqslant 0\)). In this case, the number of valid
              staircases is 1. Therefore, \[ w(n,m,s)=\begin{cases} 0,\quad n
              &gt; m(m+1)/2\\[0.5em] 1,\quad n=0 \text{ and } s\leqslant 0
              \\[0.5em] \sum_{k=1}^{\min(n,m)} w(n-k,k-1,s-1) \end{cases} \]
              with the solution is given by \(w(n,n,2)\).
            </p>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    _ways <span style="color:#d2cd86; ">=</span> <span style="color:#b060b0; ">{</span><span style="color:#b060b0; ">}</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> ways<span style="color:#d2cd86; ">(</span>x<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> x <span style="color:#e66170; font-weight:bold; ">in</span> _ways<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">return</span> _ways<span style="color:#d2cd86; ">[</span>x<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        N<span style="color:#d2cd86; ">,</span> M<span style="color:#d2cd86; ">,</span> S <span style="color:#d2cd86; ">=</span> x</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> N <span style="color:#00dddd; ">&gt;</span> M<span style="color:#00dddd; ">*</span><span style="color:#d2cd86; ">(</span>M<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">//</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            result <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">elif</span> S <span style="color:#00dddd; ">&lt;=</span> <span style="color:#00a800; ">0</span> <span style="color:#e66170; font-weight:bold; ">and</span> N <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            result <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">else</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            heights <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span> <span style="color:#e66170; font-weight:bold; ">min</span><span style="color:#d2cd86; ">(</span>M<span style="color:#d2cd86; ">,</span>N<span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            result <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">sum</span><span style="color:#d2cd86; ">(</span>ways<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">(</span>N<span style="color:#00dddd; ">-</span>k<span style="color:#d2cd86; ">,</span> k<span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span> <span style="color:#e66170; font-weight:bold; ">max</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">,</span> S<span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> k <span style="color:#e66170; font-weight:bold; ">in</span> heights<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        _ways<span style="color:#d2cd86; ">[</span>x<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> result</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> result</span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> ways<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">,</span> n<span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span></pre>
          </section>
          <section class="foobar-task" id="sec-task-6">
            <div class="foobar-task-description">
              Fuel Injection Perfection<br />
              =========================<br />
              <br />
              Write a function called solution(n) which takes a positive integer
              as a string and returns the minimum number of operations needed to
              transform n to 1. Quantities will not exceed 309 digits long. The
              three allowed operations are +1, -1 and /2 (if the quantity is
              even).<br />
              <br />
              For example:<br />
              n = 4 requires two operations: 4 -> 2 -> 1<br />
              n = 15 requires five operations: 15 -> 16 -> 8 -> 4 -> 2 -> 1<br />
              <br />
              -- Test cases --<br />
              Input : solution('15')<br />
              Output: 5<br />
              <br />
              Input : solution('4')<br />
              Output: 2
            </div>
            <p>
              To solve the problem we can identify several principles for
              minimising the number of operations to reach 1. Firstly, no
              shortest trajectory would contain a \(+1\) operation immediately
              followed by a \(-1\) operation, or vice versa, because any
              trajectory containing any such consecutive operations could be
              shortened by 2 steps by removing them. Secondly, even numbers
              should always be divided by 2. This is because a trajectory that
              repeats the other operations followed by a division can be
              shortened by dividing first. For example, $$\begin{aligned} &2k
              \rightarrow 2k\pm 1 \rightarrow 2k\pm 2 \rightarrow k\pm 1, \\ &2k
              \rightarrow k \hphantom{2+1} \rightarrow k\pm 1, \end{aligned}$$
              where \(k\) is any natural number. Basically, the number of
              consecutive addition or subtraction operations can be cut in half
              (or half plus 1) by dividing first. Note that this assumes that
              eventually there will be another halving operation. Except in the
              cases of \(n=2\) and \(n=3\) where both halving and subtracting 1
              will work, in every other case halving requires fewer operations
              than subtracting 1. Specifically, continuously subtracting 1
              requires exactly \(n-1\) operations, while halving every even and
              subtracting 1 off every odd number will require no more than
              \(2\lceil \log_2 (n+1) \rceil -2\) (when \(n\) is one less than a
              power of 2) operations and no less than \(\lceil \log_2 n \rceil\)
              (when \(n\) is a power of 2) operations. Obviously, repeated
              additions can never reach 1 since they strictly increase the
              number. Therefore, for all \(n &gt; 3\) there exists a shortest
              sequence of operations whereby every even value is halved, and the
              number of even values is at least one.<br />
              <br />
              To decide on a rule for odd values, let us consider the two
              possible cases where \(n=4k+1\) and \(n=4k+3\) for any natural
              number, \(k\). In the first case we can draw the following
              tree.<br />
              <br />
              <!-- 
                \begin{tikzpicture}[]
  % Define styles for the nodes
  \tikzstyle{block} = [text width=0.9cm, text centered]

  % Place nodes
  \node [block] (n1) {$4k+1$};
  \node [block, above right=0.1cm and 0.4cm of n1] (n2) {$4k+2$};
  \node [block, right = 0.4cm of n2 ] (n3) {$2k+1$};
  \node [block, above right=0.01cm and 0.4cm of n3] (n4) {$2k+2$};
  \node [block, right = 0.4cm of n4] (n5) {$k+1$};
  \node [block, below right=0.01cm and 0.4cm of n3] (n6) {$2k$};
  \node [block, right = 0.4cm of n6] (n7) {$k$};
  \node [block, below right=0.15cm and 0.4cm of n1] (n8) {$4k$};
  \node [block, right = 0.4cm of n8] (n9) {$2k$};
  \node [block, right = 0.4cm of n9] (n10) {$k$};
  \node [color = red, right = 0.4cm of n10] (n11) {$k+1$};
  \node [rectangle, color = red, draw, minimum height = 0.7cm, minimum width = 2.5cm] at (5.55cm,-0.66cm) (r1) {};
  \node [rectangle, color = red, draw, minimum height = 1.7cm, minimum width = 1cm] at (6.2cm,0.66cm) (r1) {};

  % Draw edges
  \draw [->] (n1) -- (n2);
  \draw [->] (n2) -- (n3);
  \draw [->] (n3) -- (n4);
  \draw [->] (n4) -- (n5);
  \draw [->] (n3) -- (n6);
  \draw [->] (n6) -- (n7);
  \draw [->] (n1) -- (n8);
  \draw [->] (n6) -- (n7);
  \draw [->] (n8) -- (n9);
  \draw [->] (n9) -- (n10);
  \draw [->, color = red] (n10) -- (n11);
\end{tikzpicture}
               -->
              <img
                src="/images/foobar/foobar_c3c_a.svg"
                alt="flow diagram"
                class="tikz-diagram"
              /><br />
              In this case adding 1 inevitably leads to either \(k\) or \(k+1\),
              both of which can be reached in fewer or equal number of
              operations by subtracting 1. Therefore, when \(n=4k+1\)
              subtracting 1 is weakly faster than adding 1. Given this strategy,
              we can make an analogous decision tree for the \(n=4k+3\) case.<br />
              <br />
              <!-- 
                \begin{tikzpicture}[]
  % Define styles for the nodes
  \tikzstyle{block} = [text width=0.9cm, text centered]

  % Place nodes
  \node [block] (n1) {$4k+3$};
  \node [block, above right=0.1cm and 0.4cm of n1] (n2) {$4k+2$};
  \node [block, right = 0.4cm of n2 ] (n3) {$2k+1$};
  \node [block, above right=0.01cm and 0.4cm of n3] (n4) {$2k$};
  \node [block, right = 0.4cm of n4] (n5) {$k$};
  \node [block, below right=0.01cm and 0.4cm of n3] (n6) {$2k+2$};
  \node [block, right = 0.4cm of n6] (n7) {$k+1$};
  \node [block, below right=0.15cm and 0.4cm of n1] (n8) {$4k+4$};
  \node [block, right = 0.4cm of n8] (n9) {$2k+2$};
  \node [block, right = 0.4cm of n9] (n10) {$k+1$};
  \node [color = red, text centered, right = 0.4cm of n10] (n11) {$k$};
  \node [rectangle, color = red, draw, minimum height = 0.7cm, minimum width = 1.9cm] at (5.1cm,-0.66cm) (r1) {};
  \node [rectangle, color = red, draw, minimum height = 1.7cm, minimum width = 1cm] at (6.2cm,0.66cm) (r1) {};

  % Draw edges
  \draw [->] (n1) -- (n2);
  \draw [->] (n2) -- (n3);
  \draw [->] (n3) -- (n4);
  \draw [->] (n4) -- (n5);
  \draw [->] (n3) -- (n6);
  \draw [->] (n6) -- (n7);
  \draw [->] (n1) -- (n8);
  \draw [->] (n6) -- (n7);
  \draw [->] (n8) -- (n9);
  \draw [->] (n9) -- (n10);
  \draw [->, color = red] (n10) -- (n11);
\end{tikzpicture}
               -->
              <img
                src="/images/foobar/foobar_c3c_b.svg"
                alt="flow diagram"
                class="tikz-diagram"
              /><br />
              Now choosing to subtract 1 will inevitably lead to either \(k\) or
              \(k+1\), both of which can be reached in fewer or equal number of
              operations by adding 1. Therefore, when \(n=4k+3\) adding 1 is
              weakly faster than subtracting 1. <br />
              <br />
              Finally, let us consider the simple small cases of which cannot be
              expressed as \(n=4k+r\). When \(n=1\) we do not need any
              operations so return 0, when \(n=2\) follow the halving even rule
              to get to 1 needs only 1 operation, and when \(n=3\) subtracting
              1, rather than adding 1 is faster. Therefore, we can define the
              following recursive function to solve the problem, \[
              f(n)=\begin{cases} 0, & n = 1,\\[0.5em] 1 + f(n/2), & n \equiv 0
              \mod{2},\\[0.5em] 1 + f(n-1), & n \equiv 1 \mod{4}, \text{ or }
              n=3, \\[0.5em] 1 + f(n+1), & \text{otherwise.} \end{cases} \] This
              solution can be implemented using a recursive function or a while
              loop.
            </p>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    n <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">long</span><span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    count <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">while</span> n <span style="color:#00dddd; ">&gt;</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        count <span style="color:#00dddd; ">+</span><span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">        n1<span style="color:#d2cd86; ">,</span> r1 <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">divmod</span><span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        n2<span style="color:#d2cd86; ">,</span> r2 <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">divmod</span><span style="color:#d2cd86; ">(</span>n1<span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> r1 <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            n <span style="color:#d2cd86; ">=</span> n1</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">elif</span> <span style="color:#d2cd86; ">(</span>r2 <span style="color:#00dddd; ">!=</span> r1<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">or</span> n <span style="color:#00dddd; ">==</span> <span style="color:#00a800; ">3</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            n <span style="color:#00dddd; ">-</span><span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">else</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            n <span style="color:#00dddd; ">+</span><span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> count</span></pre>
          </section>
        </section>
        <section class="foobar-challenge" id="sec-challenge4">
          <h2>Challenge 4</h2>
          <!-- <div class="table-of-contents toc-layer2">
            <a href="#sec-task-7">Bringing a Gun to a Trainer Fight</a>
            <a href="#sec-task-8">Free the Bunny Workers</a>
          </div> -->
          <p>
            The fourth level contained two tasks, titled
            <a href="#sec-task-7">Bringing a Gun to a Trainer Fight</a> and
            <a href="#sec-task-8">Free the Bunny Workers</a>.
          </p>
          <section class="foobar-task" id="sec-task-7">
            <div class="foobar-task-description">
              Bringing a Gun to a Trainer Fight<br />
              =================================<br />
              <br />
              Write a function solution(dimensions, your_position,
              trainer_position, distance) that gives an array of 2 integers of
              the width and height of the room, an array of 2 integers of your x
              and y coordinates in the room, an array of 2 integers of the
              trainer's x and y coordinates in the room, and returns an integer
              of the number of distinct directions that you can fire to hit the
              elite trainer, given the maximum distance that the beam can
              travel.<br />
              <br />
              The room has integer dimensions [1 &lt; x_dim &lt;= 1250, 1 &lt;
              y_dim &lt;= 1250]. You and the elite trainer are both positioned
              on the integer lattice at different distinct positions (x, y)
              inside the room such that [0 &lt; x &lt; x_dim, 0 &lt; y &lt;
              y_dim]. Finally, the maximum distance that the beam can travel
              before becoming harmless will be given as an integer 1 &lt;
              distance &lt;= 10000.<br />
              <br />
              For example, if you and the elite trainer were positioned in a
              room with dimensions [3, 2], your_position [1, 1],
              trainer_position [2, 1], and a maximum shot distance of 4, you
              could shoot in seven different directions to hit the elite trainer
              (given as vector bearings from your location): [1, 0], [1, 2], [1,
              -2], [3, 2], [3, -2], [-3, 2], and [-3, -2]. As specific examples,
              the shot at bearing [1, 0] is the straight line horizontal shot of
              distance 1, the shot at bearing [-3, -2] bounces off the left wall
              and then the bottom wall before hitting the elite trainer with a
              total shot distance of sqrt(13), and the shot at bearing [1, 2]
              bounces off just the top wall before hitting the elite trainer
              with a total shot distance of sqrt(5).<br />
              <br />
              -- Test cases --<br />
              Input : solution([3,2], [1,1], [2,1], 4)<br />
              Output: 7<br />
              <br />
              Input : solution([300,275], [150,150], [185,100], 500)<br />
              Output: 9
            </div>
            <p>
              The key insight which helped me solve this problem was to view
              reflections as additional rooms (but mirrored). Therefore, the
              reflections form an infinite grid of repeated mirror copies of the
              room. This concept is illustrated below using the example in the
              task description. Therefore, I solved this problem by following
              these steps. Firstly, I generated all coordinates corresponding to
              all positions (both yours and the targets, both real and
              reflected) in a square shape with side length larger than the
              allowed distance. Then I filtered these coordinates to only allow
              points within the allowed distance to you. From these coordinates,
              I identified a set of directions, which were the vectors from you
              to the coordinate, scaled by the greatest common divisor of both
              dimensions. For each direction the shortest distance was saved.
              Next I removed any directions to hit the target that would hit
              yourself first (directions that appear in both sets in which the
              distance to hit yourself was shorter.) The final result is the
              size of the set of directions to hit the target.
              <figure>
                <table class="grid-table" cellspacing="0" cellpadding="0">
                  <tbody>
                    <tr>
                      <td>7</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                    </tr>
                    <tr>
                      <td>6</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                    </tr>
                    <tr>
                      <td>5</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s4">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                    </tr>
                    <tr>
                      <td>4</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s5"></td>
                      <td class="s6">+</td>
                      <td class="s6"></td>
                      <td class="s5"></td>
                      <td class="s6">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                    </tr>
                    <tr>
                      <td>3</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s7">T</td>
                      <td class="s8">Y</td>
                      <td class="s9">|</td>
                      <td class="s4">Y</td>
                      <td class="s10">T</td>
                      <td class="s9">|</td>
                      <td class="s7">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                    </tr>
                    <tr>
                      <td>2</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s6"></td>
                      <td class="s5"></td>
                      <td class="s6">+</td>
                      <td class="s6"></td>
                      <td class="s5"></td>
                      <td class="s6">+</td>
                      <td class="s6"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                    </tr>
                    <tr>
                      <td>1</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s9">|</td>
                      <td class="s4">T</td>
                      <td class="s8">Y</td>
                      <td class="s11">|</td>
                      <td class="s12">Y</td>
                      <td class="s10">T</td>
                      <td class="s9">|</td>
                      <td class="s9">T</td>
                      <td class="s8">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                    </tr>
                    <tr>
                      <td>0</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s6"></td>
                      <td class="s5"></td>
                      <td class="s13">+</td>
                      <td class="s13"></td>
                      <td class="s14"></td>
                      <td class="s6">+</td>
                      <td class="s6"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                    </tr>
                    <tr>
                      <td>-1</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s7">T</td>
                      <td class="s8">Y</td>
                      <td class="s9">|</td>
                      <td class="s4">Y</td>
                      <td class="s10">T</td>
                      <td class="s9">|</td>
                      <td class="s7">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                    </tr>
                    <tr>
                      <td class="table-y-axis">-2</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s5"></td>
                      <td class="s6">+</td>
                      <td class="s6"></td>
                      <td class="s5"></td>
                      <td class="s6">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                    </tr>
                    <tr>
                      <td class="table-y-axis">-3</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s4">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                    </tr>
                    <tr>
                      <td class="table-y-axis">-4</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                      <td class="s3"></td>
                      <td class="s2">+</td>
                      <td class="s2"></td>
                    </tr>
                    <tr>
                      <td class="table-y-axis">-5</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                      <td class="s1">T</td>
                      <td class="s0">|</td>
                      <td class="s0">T</td>
                      <td class="s1">Y</td>
                      <td class="s0">|</td>
                      <td class="s0">Y</td>
                    </tr>
                    <tr>
                      <td class="table-bottom-left"></td>
                      <td class="table-x-axis">-5</td>
                      <td class="table-x-axis">-4</td>
                      <td class="table-x-axis">-3</td>
                      <td class="table-x-axis">-2</td>
                      <td class="table-x-axis">-1</td>
                      <td class="table-x-axis">0</td>
                      <td class="table-x-axis">1</td>
                      <td class="table-x-axis">2</td>
                      <td class="table-x-axis">3</td>
                      <td class="table-x-axis">4</td>
                      <td class="table-x-axis">5</td>
                      <td class="table-x-axis">6</td>
                      <td class="table-x-axis">7</td>
                    </tr>
                  </tbody>
                </table>
                <figcaption>
                  Illustrated example from the task description. The shaded
                  region represents cells in range of you. Cells shaded in green
                  denote the directions which would hit the target.
                </figcaption>
              </figure>
            </p>

            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>dimensions<span style="color:#d2cd86; ">,</span> your_position<span style="color:#d2cd86; ">,</span> trainer_position<span style="color:#d2cd86; ">,</span> distance<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> norm<span style="color:#d2cd86; ">(</span>v<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Euclidean norm</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">sum</span><span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">**</span><span style="color:#00a800; ">2</span> <span style="color:#e66170; font-weight:bold; ">for</span> x <span style="color:#e66170; font-weight:bold; ">in</span> v<span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">**</span><span style="color:#009f00; ">0.5</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> gcd<span style="color:#d2cd86; ">(</span>a<span style="color:#d2cd86; ">,</span> b<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Euclidean algorithm to find the greatest common divisor</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># a and b should be positive integers</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">while</span> b <span style="color:#00dddd; ">!=</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            a<span style="color:#d2cd86; ">,</span> b <span style="color:#d2cd86; ">=</span> b<span style="color:#d2cd86; ">,</span> a <span style="color:#00dddd; ">%</span> b</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> a</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> get_direction<span style="color:#d2cd86; ">(</span>v<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Rescales vector v by greatest common divisor</span></span>
<span class="line_wrapper">        f <span style="color:#d2cd86; ">=</span> gcd<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">abs</span><span style="color:#d2cd86; ">(</span>v<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> <span style="color:#e66170; font-weight:bold; ">abs</span><span style="color:#d2cd86; ">(</span>v<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">tuple</span><span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">//</span>f <span style="color:#e66170; font-weight:bold; ">for</span> x <span style="color:#e66170; font-weight:bold; ">in</span> v<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> repeat<span style="color:#d2cd86; ">(</span>z<span style="color:#d2cd86; ">,</span> z_dim<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Generates a list of coordinates that show all reflections along a</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># partcular dimension.</span></span>
<span class="line_wrapper">        values <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span><span style="color:#00dddd; ">-</span>z<span style="color:#d2cd86; ">,</span> z<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> i <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">,</span> distance<span style="color:#00dddd; ">//</span>z_dim <span style="color:#00dddd; ">+</span> <span style="color:#00a800; ">3</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            values<span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>i<span style="color:#00dddd; ">*</span>z_dim <span style="color:#00dddd; ">-</span> z<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            values<span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>i<span style="color:#00dddd; ">*</span>z_dim <span style="color:#00dddd; ">+</span> z<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            values <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span><span style="color:#00dddd; ">-</span>i<span style="color:#00dddd; ">*</span>z_dim <span style="color:#00dddd; ">-</span> z<span style="color:#d2cd86; ">,</span> z <span style="color:#00dddd; ">-</span> i<span style="color:#00dddd; ">*</span>z_dim<span style="color:#d2cd86; ">]</span> <span style="color:#00dddd; ">+</span> values</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> values</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Compute the directions and distances to shoot yourself</span></span>
<span class="line_wrapper">    y_reflects <span style="color:#d2cd86; ">=</span> <span style="color:#b060b0; ">{</span><span style="color:#b060b0; ">}</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> x <span style="color:#e66170; font-weight:bold; ">in</span> repeat<span style="color:#d2cd86; ">(</span>your_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> dimensions<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> y <span style="color:#e66170; font-weight:bold; ">in</span> repeat<span style="color:#d2cd86; ">(</span>your_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> dimensions<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            p <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">-</span>your_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span>y<span style="color:#00dddd; ">-</span>your_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            n <span style="color:#d2cd86; ">=</span> norm<span style="color:#d2cd86; ">(</span>p<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> p <span style="color:#00dddd; ">!=</span> <span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">,</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">and</span> n <span style="color:#00dddd; ">&lt;=</span> distance<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                direction <span style="color:#d2cd86; ">=</span> get_direction<span style="color:#d2cd86; ">(</span>p<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">if</span> direction <span style="color:#e66170; font-weight:bold; ">in</span> y_reflects<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    y_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">min</span><span style="color:#d2cd86; ">(</span>y_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> n<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">else</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    y_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> n</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Compute the directions and distances to shoot the target</span></span>
<span class="line_wrapper">    t_reflects <span style="color:#d2cd86; ">=</span> <span style="color:#b060b0; ">{</span><span style="color:#b060b0; ">}</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> x <span style="color:#e66170; font-weight:bold; ">in</span> repeat<span style="color:#d2cd86; ">(</span>trainer_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> dimensions<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> y <span style="color:#e66170; font-weight:bold; ">in</span> repeat<span style="color:#d2cd86; ">(</span>trainer_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> dimensions<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            p <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">(</span>x<span style="color:#00dddd; ">-</span>your_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span>y<span style="color:#00dddd; ">-</span>your_position<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            n <span style="color:#d2cd86; ">=</span> norm<span style="color:#d2cd86; ">(</span>p<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> p <span style="color:#00dddd; ">!=</span> <span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">,</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">and</span> n <span style="color:#00dddd; ">&lt;=</span> distance<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                direction <span style="color:#d2cd86; ">=</span> get_direction<span style="color:#d2cd86; ">(</span>p<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">if</span> direction <span style="color:#e66170; font-weight:bold; ">in</span> t_reflects<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    t_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">min</span><span style="color:#d2cd86; ">(</span>t_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> n<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">                <span style="color:#e66170; font-weight:bold; ">else</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                    t_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span> <span style="color:#d2cd86; ">=</span> n</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># find directions which would hit yourself before the target</span></span>
<span class="line_wrapper">    delete <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> direction <span style="color:#e66170; font-weight:bold; ">in</span> t_reflects<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> direction <span style="color:#e66170; font-weight:bold; ">in</span> y_reflects<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> y_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span> <span style="color:#00dddd; ">&lt;</span> t_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                delete<span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>direction<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># delete those directions</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> direction <span style="color:#e66170; font-weight:bold; ">in</span> delete<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">del</span> t_reflects<span style="color:#d2cd86; ">[</span>direction<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    num_dir <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>t_reflects<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> num_dir</span></pre>
          </section>
          <section class="foobar-task" id="sec-task-8">
            <div class="foobar-task-description">
              Free the Bunny Workers<br />
              ======================<br />
              <br />
              Given the number of bunnies available and the number of locks
              required to open a work room, write a function solution(num_buns,
              num_required) which returns a specification of how to distribute
              the keys such that any num_required bunnies can open the locks,
              but no group of (num_required - 1) bunnies can.<br />
              <br />
              Each lock is numbered starting from 0. The keys are numbered the
              same as the lock they open (so for a duplicate key, the number
              will repeat, since it opens the same lock). For a given bunny, the
              keys they get is represented as a sorted list of the numbers for
              the keys. To cover all of the bunnies, the final solution is
              represented by a sorted list of each individual bunny's list of
              keys. Find the lexicographically least such key distribution -
              that is, the first bunny should have keys sequentially starting
              from 0.<br />
              <br />
              num_buns will always be between 1 and 9, and num_required will
              always be between 0 and 9 (both inclusive). For example, if you
              had 3 bunnies and required only 1 of them to open the cell, you
              would give each bunny the same key such that any of the 3 of them
              would be able to open it, like so:<br />
              <br />
              [<br />
              [0],<br />
              [0],<br />
              [0],<br />
              ]<br />
              <br />
              If you had 2 bunnies and required both of them to open the cell,
              they would receive different keys (otherwise they wouldn't both
              actually be required), and your solution would be as follows:<br />
              <br />
              [<br />
              [0],<br />
              [1],<br />
              ]<br />
              <br />
              Finally, if you had 3 bunnies and required 2 of them to open the
              cell, then any 2 of the 3 bunnies should have all of the keys
              necessary to open the cell, but no single bunny would be able to
              do it. Thus, the solution would be:<br />
              <br />
              [<br />
              [0, 1],<br />
              [0, 2],<br />
              [1, 2],<br />
              ]<br />
              <br />
              -- Test cases --<br />
              Input : solution(4, 4)<br />
              Output: [[0], [1], [2], [3]]<br />
              <br />
              Input : solution(5, 3)<br />
              Output: [[0, 1, 2, 3, 4, 5], [0, 1, 2, 6, 7, 8], [0, 3, 4, 6, 7,
              9], [1, 3, 5, 6, 8, 9], [2, 4, 5, 7, 8, 9]]<br />
              <br />
              Input : solution(2, 1)<br />
              Output: [[0], [0]]
            </div>
            <p>
              We know that no combination of num_required - 1 bunnies will
              collectively have all the required keys, they must be missing at
              least one key for a required lock. However, including any other
              additional bunny will complete the set of keys. Therefore, for
              every combination of num_required - 1 bunnies, every other bunny
              holds the missing keys. Therefore, we can minimally issue keys by
              assigning a set of keys for each lock to a unique combination of
              num_buns - num_required + 1. In this way, every possible
              combination of num_required will hold all required keys, and every
              possible combination of num_required - 1 will not. We know this
              minimises the total number of keys because removing any key will
              result in a combination of bunnies that cannot open that lock,
              regardless of how the keys are assigned.
            </p>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">from</span> itertools <span style="color:#e66170; font-weight:bold; ">import</span> combinations</span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>num_buns<span style="color:#d2cd86; ">,</span> num_required<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    specification <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">]</span> <span style="color:#e66170; font-weight:bold; ">for</span> i <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>num_buns<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">    comb <span style="color:#d2cd86; ">=</span> combinations<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>num_buns<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> num_buns <span style="color:#00dddd; ">-</span> num_required <span style="color:#00dddd; ">+</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> i<span style="color:#d2cd86; ">,</span> c <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">enumerate</span><span style="color:#d2cd86; ">(</span>comb<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> ind <span style="color:#e66170; font-weight:bold; ">in</span> c<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            specification<span style="color:#d2cd86; ">[</span>ind<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>i<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> specification</span></pre>
          </section>
        </section>
        <section class="foobar-challenge" id="sec-challenge5">
          <h2>Challenge 5</h2>
          <!-- <div class="table-of-contents toc-layer2">
            <a href="#sec-task-9">Dodge the Lasers!</a>
          </div> -->
          <p>
            The fifth and last level contained only a single task, titled
            <a href="#sec-task-9">Dodge the Lasers!</a>
          </p>
          <section class="foobar-task" id="sec-task-9">
            <div class="foobar-task-description">
              Dodge the Lasers!<br />
              =================<br />
              <br />
              Write a function solution(str_n) which, given the string
              representation of an integer n, returns the sum of
              (floor(1*sqrt(2)) + floor(2*sqrt(2)) + ... + floor(n*sqrt(2))) as
              a string. That is, for every number i in the range 1 to n, it adds
              up all of the integer portions of i*sqrt(2).<br />
              <br />
              For example, if str_n was "5", the solution would be calculated
              as<br />
              floor(1*sqrt(2)) +<br />
              floor(2*sqrt(2)) +<br />
              floor(3*sqrt(2)) +<br />
              floor(4*sqrt(2)) +<br />
              floor(5*sqrt(2))<br />
              = 1+2+4+5+7 = 19<br />
              so the function would return "19".<br />
              <br />
              str_n will be a positive integer between 1 and 10^100, inclusive.
              Since n can be very large (up to 101 digits!), using just sqrt(2)
              and a loop won't work. Sometimes, it's easier to take a step back
              and concentrate not on what you have in front of you, but on what
              you don't.<br />
              <br />
              -- Test cases --<br />
              Input : solution('77')<br />
              Output: 4208<br />
              <br />
              Input : solution('5')<br />
              Output: 19
            </div>
            <p>
              The task is essentially to code a function that can evaluate
              \[f(n) = \sum_{i=1}^n \lfloor i \sqrt{2} \rfloor\] for any integer
              \(1 \leqslant n \leqslant 10^{100}\). In my first attempt to solve
              this problem I used the Fourier series to derive an approximate
              solution, and then guess and checked to "hack" the verification
              process to tweak the result to pass the checks. The fractional
              part of a number \(x\), the difference between the number and its
              floor, forms a
              <a
                href="https://en.wikipedia.org/wiki/Sawtooth_wave"
                target="_blank"
                >sawtooth function</a
              >
              with a known
              <a
                href="https://en.wikipedia.org/wiki/Fourier_series"
                target="_blank"
                >Fourier series</a
              >, \[\lbrace x\rbrace = x - \lfloor x \rfloor = {1 \over 2} - {1
              \over \pi} \sum_{k=1}^\infty{\sin(2\pi k x) \over k}.\] Therefore,
              we can express the function \(f(n)\) as an infinite series,
              $$\begin{aligned} f(n) &= \sum_{i=1}^n \lfloor i \sqrt{2} \rfloor,
              \\ &= \sum_{i=1}^n \left[ i \sqrt{2} -{1 \over 2} + {1 \over \pi}
              \sum_{k=1}^\infty{\sin(2\pi k i \sqrt{2}) \over k} \right], \\ &=
              {n(n+1)\over \sqrt{2}} -{n \over 2} + {1 \over \pi}
              \sum_{k=1}^\infty {\sin\left(\sqrt{2}\pi k n\right)
              \sin\left(\sqrt{2}\pi k (n+1)\right)\over k \sin\left(\sqrt{2}\pi
              k\right)}. \end{aligned}$$ The problem with this approach is that
              the infinite series sometimes converged very slowly, requiring too
              many terms to stabilise. Furthermore, passing the checks via guess
              and check did not leave me with a satisfying ending to an
              otherwise rewarding challenge. Therefore, I continued working on
              the problem, and during some research I discovered a breakthrough.
              The key insight into solving this problem is to identify the
              summand as a
              <a
                href="https://en.wikipedia.org/wiki/Beatty_sequence"
                target="_blank"
              >
                Beatty sequence</a
              >. The trick is to exploit the complementary Beatty sequence to
              create a recursive formula to compute the series. Let the largest
              term be \(m=\lfloor n\sqrt{2} \rfloor\), $$\begin{aligned} f(n) &=
              \sum_{k=1}^n \lfloor k\sqrt{2} \rfloor, \\ &= \sum_{k=1}^m k -
              \sum_{k=1}^{m-n} \lfloor k(2+\sqrt{2}) \rfloor, \\ &= \sum_{k=1}^m
              k - 2\sum_{k=1}^{m-n} k - \sum_{k=1}^{m-n} \lfloor k\sqrt{2}
              \rfloor, \\ &= {m(m+1)\over 2} - (m-n)(m-n+1) - f(m-n).
              \end{aligned}$$ The size of the function argument is reduced by a
              factor of at least \(\sqrt{2}-1 &lt; 0.5 \). Therefore, the depth
              of the recursion is bounded by \(\log_2 n\) for large enough
              \(n\), and is approximately \(-\log_2 n / \log_2(\sqrt{2}-1)\).
              <br />
              <br />
              Note that the code must be able to compute \(m=\lfloor n\sqrt{2}
              \rfloor\). The naive approach would require \(\sqrt{2}\) to be
              known to very high precision. Instead, I accomplished this by
              computing \(m=\lfloor \sqrt{2n^2} \rfloor\) using a form of
              <a
                href="https://en.wikipedia.org/wiki/Integer_square_root#Using_only_integer_division"
                target="_blank"
                >Heron's method</a
              >
              that was adapted for integer operations only.
            </p>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>str_n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> f<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> n <span style="color:#00dddd; ">&lt;=</span> <span style="color:#00a800; ">6</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">3</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">7</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">12</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">19</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">27</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">[</span>n<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        n2 <span style="color:#d2cd86; ">=</span> floorsqrt<span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">2</span><span style="color:#00dddd; ">*</span>n<span style="color:#00dddd; ">*</span>n<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        n3 <span style="color:#d2cd86; ">=</span> n2<span style="color:#00dddd; ">-</span>n</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> n2<span style="color:#00dddd; ">*</span><span style="color:#d2cd86; ">(</span>n2<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">//</span><span style="color:#00a800; ">2</span> <span style="color:#00dddd; ">-</span> n3<span style="color:#00dddd; ">*</span><span style="color:#d2cd86; ">(</span>n3<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">-</span> f<span style="color:#d2cd86; ">(</span>n3<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">str</span><span style="color:#d2cd86; ">(</span>f<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">(</span>str_n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> floorsqrt<span style="color:#d2cd86; ">(</span>k<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    e0<span style="color:#d2cd86; ">,</span> e <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">4</span><span style="color:#00dddd; ">*</span><span style="color:#00a800; ">10</span><span style="color:#00dddd; ">**</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">str</span><span style="color:#d2cd86; ">(</span>k<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">//</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> k</span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">while</span> e0 <span style="color:#00dddd; ">&lt;</span> e<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        e0<span style="color:#d2cd86; ">,</span> e <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">(</span>e0 <span style="color:#00dddd; ">+</span> k<span style="color:#00dddd; ">//</span>e0<span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">//</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">,</span> e0</span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> e</span></pre>
          </section>
        </section>
        <section class="foobar-challenge" id="sec-bonus">
          <h2>Bonus Tasks</h2>
          <p>
            After completing all five levels of the challenge, I found that I
            could still request new tasks. I believe these bonus tasks are
            alternative or old level 5 tasks.
          </p>
          <section class="foobar-task" id="sec-task-10">
            <div class="foobar-task-description">
              Expanding Nebula<br />
              ================<br />
              The gas of the steadily expanding nebula can be modelled as a 2D
              grid. You find that the current existence of gas in a cell of the
              grid is determined exactly by its 4 nearby cells, specifically,
              (1) that cell, (2) the cell below it, (3) the cell to the right of
              it, and (4) the cell below and to the right of it. If, in the
              current state, exactly 1 of those 4 cells in the 2x2 block has
              gas, then it will also have gas in the next state. Otherwise, the
              cell will be empty in the next state.<br />
              <br />
              For example, let's say the previous state of the grid (p) was:<br />
              .O..<br />
              ..O.<br />
              ...O<br />
              O...<br />
              <br />
              To see how this grid will change to become the current grid (c)
              over the next time step, consider the 2x2 blocks of cells around
              each cell. Of the 2x2 block of [p[0][0], p[0][1], p[1][0],
              p[1][1]], only p[0][1] has gas in it, which means this 2x2 block
              would become cell c[0][0] with gas in the next time step:<br />
              .O -> O<br />
              ..<br />
              <br />
              Likewise, in the next 2x2 block to the right consisting of
              [p[0][1], p[0][2], p[1][1], p[1][2]], two of the containing cells
              have gas, so in the next state of the grid, c[0][1] will NOT have
              gas:<br />
              O. -> .<br />
              .O<br />
              <br />
              Following this pattern to its conclusion, from the previous state
              p, the current state of the grid c will be:<br />
              O.O<br />
              .O.<br />
              O.O<br />
              <br />
              Note that the resulting output will have 1 fewer row and column,
              since the bottom and rightmost cells do not have a cell below and
              to the right of them, respectively.<br />
              <br />
              Write a function solution(g) where g is an array of array of bools
              saying whether there is gas in each cell (the current scan of the
              nebula), and return an int with the number of possible previous
              states that could have resulted in that grid after 1 time step.
              For instance, if the function were given the current state c
              above, it would deduce that the possible previous states were p
              (given above) as well as its horizontal and vertical reflections,
              and would return 4. The width of the grid will be between 3 and 50
              inclusive, and the height of the grid will be between 3 and 9
              inclusive. The solution will always be less than one billion
              (10^9).<br />
              <br />
              -- Test cases --<br />
              Input: solution([[True, True, False, True, False, True, False,
              True, True, False], [True, True, False, False, False, False, True,
              True, True, False], [True, True, False, False, False, False,
              False, False, False, True], [False, True, False, False, False,
              False, True, True, False, False]])<br />
              Output: 11567<br />
              <br />
              Input: solution([[True, False, True], [False, True, False], [True,
              False, True]])<br />
              Output: 4<br />
              <br />
              Input: solution([[True, False, True, False, False, True, True,
              True], [True, False, True, False, False, False, True, False],
              [True, True, True, False, False, False, True, False], [True,
              False, True, False, False, False, True, False], [True, False,
              True, False, False, True, True, True]])<br />
              Output: 254
            </div>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">from</span> collections <span style="color:#e66170; font-weight:bold; ">import</span> defaultdict</span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>g<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; ">"""Returns the number of unique states that can step into g</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    g is a boolean array (list of lists of bools) that is an outcome of a</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    previous state, s, such that for all rows and cols g[row][col] is True</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    if and only if exactly one of the following is True:</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    s[row][col], s[row+1][col], s[row][col+1], s[row+1][col+1].</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    solution(g) returns the number of unique previous states s that can</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    produce g. It does this efficiently in four steps:</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Firstly, rows of g and s are represented as the decimal integers that</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        are equal to a binary integer where each digit is given by the column</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        of that row. For example, [True, False, True] is "101" in binary which</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        is equal to 5 in decimal. Representing the rows as integers allows</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        efficient boolean computations using the bitwise operations</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        &amp;, |, &lt;&lt;, &gt;&gt;.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Secondly, every combination of row pairs of s is simulated to generate</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        a possible row in g. If such a row exists in g, then these potential</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        row pairs are recorded in a dictionary called potentials.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Thirdly, for every row in g, all possible values of the corresponding</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        row in g are tracked as well as the number of unique ways to reach that</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        combination, given all the previous rows.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Fourthly, the total number of unique states, s, is given by adding up</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        the number of ways the last row of s is possible for each possible</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        value of that last row.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Parameters</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    ----------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    g : list</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        list of lists of boolean values with 3-9 rows inclusive, and 3-50</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        columns inclusive.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Returns</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    -------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    num_states : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        The number of possible previous states that could have resulted in g.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        The solution will always be less than one billion (10^9).</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    """</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Minimise the number of columns by transposition</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># This minimizes the number of combinations in two rows</span></span>
<span class="line_wrapper">    n<span style="color:#d2cd86; ">,</span> m <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>g<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>g<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">if</span> m <span style="color:#00dddd; ">&gt;</span> n<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        g <span style="color:#d2cd86; ">=</span> transpose<span style="color:#d2cd86; ">(</span>g<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        n<span style="color:#d2cd86; ">,</span> m <span style="color:#d2cd86; ">=</span> m<span style="color:#d2cd86; ">,</span> n</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Represent each row of g as an integer</span></span>
<span class="line_wrapper">    g_ints <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span>bool_list2int<span style="color:#d2cd86; ">(</span>bl<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> bl <span style="color:#e66170; font-weight:bold; ">in</span> g<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Find all row pairs that can step into rows of g</span></span>
<span class="line_wrapper">    potentials <span style="color:#d2cd86; ">=</span> find_potentials<span style="color:#d2cd86; ">(</span>g_ints<span style="color:#d2cd86; ">,</span> m<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Go through each row of g_ints, keeping track of possible rows of the</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># previous row in the previous time step, and the number of ways that row</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># is possible.</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Initially the first row of the previous timestep could be anything with</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># 1 way for each possibility.</span></span>
<span class="line_wrapper">    previous_row <span style="color:#d2cd86; ">=</span> <span style="color:#b060b0; ">{</span>i <span style="color:#d2cd86; ">:</span> <span style="color:#00a800; ">1</span> <span style="color:#e66170; font-weight:bold; ">for</span> i <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">2</span><span style="color:#00dddd; ">**</span><span style="color:#d2cd86; ">(</span>m<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#b060b0; ">}</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> row <span style="color:#e66170; font-weight:bold; ">in</span> g_ints<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># current_row tracks the possible values of the current row in the</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># previous timestep as keys, and the number of ways to reach that</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># state as the value.</span></span>
<span class="line_wrapper">        current_row <span style="color:#d2cd86; ">=</span> defaultdict<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> i <span style="color:#e66170; font-weight:bold; ">in</span> previous_row<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">for</span> j <span style="color:#e66170; font-weight:bold; ">in</span> potentials<span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">(</span>row<span style="color:#d2cd86; ">,</span> i<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                <span style="color:#9999a9; "># Accumulate the num of ways of every potential row combination</span></span>
<span class="line_wrapper">                current_row<span style="color:#d2cd86; ">[</span>j<span style="color:#d2cd86; ">]</span> <span style="color:#00dddd; ">+</span><span style="color:#d2cd86; ">=</span> previous_row<span style="color:#d2cd86; ">[</span>i<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        previous_row <span style="color:#d2cd86; ">=</span> current_row</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#9999a9; "># The total number of states that can produce the current state is the</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># sum of all ways each potential last row could be produced.</span></span>
<span class="line_wrapper">    num_states <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">sum</span><span style="color:#d2cd86; ">(</span>previous_row<span style="color:#d2cd86; ">.</span>values<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> num_states</span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> find_potentials<span style="color:#d2cd86; ">(</span>g_ints<span style="color:#d2cd86; ">,</span> m<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; ">"""Find all row pairs that can step into a row in the current boolean array</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Parameters</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    ----------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    g_ints : list</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        A list of integers where each integer represents a row in the boolean</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        array of a latter timestep.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    m : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        The number of columns in the latter array.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Returns</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    -------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    potentials : defaultdict(list)</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        A defaultdict containing all combinations of rows that step into a </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        row in g_ints. For a given key of the form (row, i), where row is an</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        integer in g_ints, the value is a list of integers that work with i to</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        step into row.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    """</span></span>
<span class="line_wrapper">    potentials <span style="color:#d2cd86; ">=</span> defaultdict<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">list</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> i <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">2</span><span style="color:#00dddd; ">**</span><span style="color:#d2cd86; ">(</span>m<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> j <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">2</span><span style="color:#00dddd; ">**</span><span style="color:#d2cd86; ">(</span>m<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            s <span style="color:#d2cd86; ">=</span> step_row_int<span style="color:#d2cd86; ">(</span>i<span style="color:#d2cd86; ">,</span>j<span style="color:#d2cd86; ">,</span>m<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">if</span> s <span style="color:#e66170; font-weight:bold; ">in</span> g_ints<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                potentials<span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">(</span>s<span style="color:#d2cd86; ">,</span>i<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span>j<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> potentials</span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> step_row_int<span style="color:#d2cd86; ">(</span>r1<span style="color:#d2cd86; ">,</span> r2<span style="color:#d2cd86; ">,</span> n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; ">"""</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Imagine the two boolean rows:</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    [</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">      [r1c1,r1c2,r1c3,...,r1cn,r1cn+1],</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">      [r2c1,r2c2,r2c3,...,r2cn,r2cn+1]</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    ]</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    r1 is the int rep of [r1c1,r1c2,r1c3,...,r1cn,r1cn+1],</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    r2 is the int rep of [r2c1,r2c2,r2c3,...,r2cn,r2cn+1],</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    a  is the int rep of [r1c1,r1c2,r1c3,...,r1cn],</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    b  is the int rep of      [r1c2,r1c3,...,r1cn,r1cn+1],</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    c is the int rep of [r2c1,r2c2,r2c3,...,r2cn],</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    d is the int rep of      [r2c2,r2c3,...,r2cn,r2cn+1],</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Parameters</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    ----------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    r1 : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Integer representation of a row of booleans.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    r2 : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Integer representation of the next row of booleans.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    n : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        The number of elements in the row after the step.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Returns</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    -------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Integer representation of the boolean row after a time step.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    """</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># [[a,b],[c,d]]</span></span>
<span class="line_wrapper">    b<span style="color:#d2cd86; ">,</span> d<span style="color:#d2cd86; ">,</span> a<span style="color:#d2cd86; ">,</span> c <span style="color:#d2cd86; ">=</span> r1 <span style="color:#00dddd; ">&amp;</span> <span style="color:#00dddd; ">~</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">1</span> <span style="color:#00dddd; ">&lt;&lt;</span> n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> r2 <span style="color:#00dddd; ">&amp;</span> <span style="color:#00dddd; ">~</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">1</span> <span style="color:#00dddd; ">&lt;&lt;</span> n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> r1 <span style="color:#00dddd; ">&gt;&gt;</span> <span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span> r2 <span style="color:#00dddd; ">&gt;&gt;</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">    na<span style="color:#d2cd86; ">,</span> nb<span style="color:#d2cd86; ">,</span> nc<span style="color:#d2cd86; ">,</span> nd <span style="color:#d2cd86; ">=</span> <span style="color:#00dddd; ">~</span>a<span style="color:#d2cd86; ">,</span> <span style="color:#00dddd; ">~</span>b<span style="color:#d2cd86; ">,</span> <span style="color:#00dddd; ">~</span>c<span style="color:#d2cd86; ">,</span> <span style="color:#00dddd; ">~</span>d</span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#d2cd86; ">(</span>a<span style="color:#00dddd; ">&amp;</span>nb<span style="color:#00dddd; ">&amp;</span>nc<span style="color:#00dddd; ">&amp;</span>nd<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">|</span> <span style="color:#d2cd86; ">(</span>na<span style="color:#00dddd; ">&amp;</span>b<span style="color:#00dddd; ">&amp;</span>nc<span style="color:#00dddd; ">&amp;</span>nd<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">|</span> <span style="color:#d2cd86; ">(</span>na<span style="color:#00dddd; ">&amp;</span>nb<span style="color:#00dddd; ">&amp;</span>c<span style="color:#00dddd; ">&amp;</span>nd<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">|</span> <span style="color:#d2cd86; ">(</span>na<span style="color:#00dddd; ">&amp;</span>nb<span style="color:#00dddd; ">&amp;</span>nc<span style="color:#00dddd; ">&amp;</span>d<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> bool_list2int<span style="color:#d2cd86; ">(</span>bool_list<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Convert list of bools to an integer (inverse of int2bool_list)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">""</span><span style="color:#d2cd86; ">.</span>join<span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">lambda</span> b <span style="color:#d2cd86; ">:</span> <span style="color:#e66170; font-weight:bold; ">str</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">(</span>b<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span>bool_list<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> int2bool_list<span style="color:#d2cd86; ">(</span>k<span style="color:#d2cd86; ">,</span> n <span style="color:#d2cd86; ">=</span> None<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Convert an integer to a list of bools (inverse of bool_list2int)</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># n is the desired list length</span></span>
<span class="line_wrapper">    bl <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">list</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">lambda</span> b <span style="color:#d2cd86; ">:</span> <span style="color:#e66170; font-weight:bold; ">bool</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">int</span><span style="color:#d2cd86; ">(</span>b<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span>format<span style="color:#d2cd86; ">(</span>k<span style="color:#d2cd86; ">,</span><span style="color:#00c4c4; ">"b"</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">if</span> n <span style="color:#e66170; font-weight:bold; ">is</span> <span style="color:#e66170; font-weight:bold; ">not</span> None<span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        bl <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">(</span>n<span style="color:#00dddd; ">-</span><span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>bl<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">*</span><span style="color:#d2cd86; ">[</span>False<span style="color:#d2cd86; ">]</span> <span style="color:#00dddd; ">+</span> bl</span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> bl</span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> transpose<span style="color:#d2cd86; ">(</span>arr<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Transpose a 2D list (list of lists of the same length)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#d2cd86; ">[</span><span style="color:#e66170; font-weight:bold; ">list</span><span style="color:#d2cd86; ">(</span>x<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> x <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">zip</span><span style="color:#d2cd86; ">(</span><span style="color:#00dddd; ">*</span>arr<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> step<span style="color:#d2cd86; ">(</span>s<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># Given a state s, returns the next state g</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; "># This function is for checking, rather than part of the solution</span></span>
<span class="line_wrapper">    m <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>s<span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">-</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">    n <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>s<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">-</span> <span style="color:#00a800; ">1</span></span>
<span class="line_wrapper">    ints <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span>bool_list2int<span style="color:#d2cd86; ">(</span>bl<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> bl <span style="color:#e66170; font-weight:bold; ">in</span> s<span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">    ints2 <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span>step_row_int<span style="color:#d2cd86; ">(</span>ints<span style="color:#d2cd86; ">[</span>i<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span>ints<span style="color:#d2cd86; ">[</span>i<span style="color:#00dddd; ">+</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span> m<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> i <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#d2cd86; ">[</span>int2bool_list<span style="color:#d2cd86; ">(</span>k<span style="color:#d2cd86; ">,</span> m<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> k <span style="color:#e66170; font-weight:bold; ">in</span> ints2<span style="color:#d2cd86; ">]</span></span></pre>
          </section>
          <section class="foobar-task" id="sec-task-11">
            <div class="foobar-task-description">
              Disorderly Escape<br />
              =================<br />
              Write a function solution(w, h, s) that takes 3 integers and
              returns the number of unique, non-equivalent configurations that
              can be found on a star grid w blocks wide and h blocks tall where
              each celestial body has s possible states. Equivalency is defined
              as above: any two star grids with each celestial body in the same
              state where the actual order of the rows and columns do not matter
              (and can thus be freely swapped around). Star grid standardization
              means that the width and height of the grid will always be between
              1 and 12, inclusive. And while there are a variety of celestial
              bodies in each grid, the number of states of those bodies is
              between 2 and 20, inclusive. The solution can be over 20 digits
              long, so return it as a decimal string. The intermediate values
              can also be large, so you will likely need to use at least 64-bit
              integers.<br />
              <br />
              For example, consider w=2, h=2, s=2. We have a 2x2 grid where each
              celestial body is either in state 0 (for instance, silent) or
              state 1 (for instance, noisy). We can examine which grids are
              equivalent by swapping rows and columns.<br />
              <br />
              00<br />
              00<br />
              <br />
              In the above configuration, all celestial bodies are "silent" -
              that is, they have a state of 0 - so any swap of row or column
              would keep it in the same state.<br />
              <br />
              00 00 01 10<br />
              01 10 00 00<br />
              <br />
              1 celestial body is emitting noise - that is, has a state of 1 -
              so swapping rows and columns can put it in any of the 4 positions.
              All four of the above configurations are equivalent.<br />
              <br />
              00 11<br />
              11 00<br />
              <br />
              2 celestial bodies are emitting noise side-by-side. Swapping
              columns leaves them unchanged, and swapping rows simply moves them
              between the top and bottom. In both, the *groupings* are the same:
              one row with two bodies in state 0, one row with two bodies in
              state 1, and two columns with one of each state.<br />
              <br />
              01 10<br />
              01 10<br />
              <br />
              2 noisy celestial bodies adjacent vertically. This is symmetric to
              the side-by-side case, but it is different because there's no way
              to transpose the grid.<br />
              <br />
              01 10<br />
              10 01<br />
              <br />
              2 noisy celestial bodies diagonally. Both have 2 rows and 2
              columns that have one of each state, so they are equivalent to
              each other.<br />
              <br />
              01 10 11 11<br />
              11 11 01 10<br />
              <br />
              3 noisy celestial bodies, similar to the case where only one of
              four is noisy.<br />
              <br />
              11<br />
              11<br />
              <br />
              4 noisy celestial bodies.<br />
              <br />
              There are 7 distinct, non-equivalent grids in total, so
              solution(2, 2, 2) would return 7.<br />
              <br />
              -- Test cases --<br />
              Input: solution(2, 3, 4)<br />
              Output: 430<br />
              <br />
              Input: solution(2, 2, 2)<br />
              Output: 7
            </div>
            <pre><span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">from</span> math <span style="color:#e66170; font-weight:bold; ">import</span> factorial</span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">from</span> collections <span style="color:#e66170; font-weight:bold; ">import</span> Counter</span>
<span class="line_wrapper"></span>
<span class="line_wrapper"><span style="color:#e66170; font-weight:bold; ">def</span> solution<span style="color:#d2cd86; ">(</span>w<span style="color:#d2cd86; ">,</span> h<span style="color:#d2cd86; ">,</span> s<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">    <span style="color:#9999a9; ">"""Returns the number of unique, non-equivalent configurations</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    The number of unique, non-equivalent configurationsthat can be found on a</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    grid w blocks wide and h blocks tall where each point has s possible</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    states. Equivalency is defined as above: any two grids with each point in</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    the same state where the actual order of the rows and columns do not matter</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    (and can thus be freely swapped around).</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    The symmetries of grids form a group. Specifically, the direct product of</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    two finite symmetric groups Sw x Sh. This is because grids are symmetric</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    under row permutations and column permutations independently. A symmetric</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    group of degree n has an order of n!, so the order of Sw x Sh is w!h!.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    The number of configurations is equivalent to the number of orbits in the</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    group Sw x Sh. This can be computed using Burnside's counting theorem.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    = 1/w!h! * sum(s^(number of cycles in g)) for every g in Sw x Sh.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Therefore, the computation can be accellerated by combining the number of </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    permutations that share the same cycles.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Parameters</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    ----------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    w : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Grid width, [1,12].</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    h : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Grid height, [1,12].</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    s : int</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Number of allowed states, [2,20].</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    Returns</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    -------</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    config : str</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">        Number of unique, non-equivalent configurations as a decimal string.</span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    </span></span>
<span class="line_wrapper"><span style="color:#9999a9; ">    """</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> gcd<span style="color:#d2cd86; ">(</span>a<span style="color:#d2cd86; ">,</span> b<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Euclidean algorithm finds the greatest common divisor of +ints a &amp; b</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">while</span> b <span style="color:#00dddd; ">!=</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            a<span style="color:#d2cd86; ">,</span> b <span style="color:#d2cd86; ">=</span> b<span style="color:#d2cd86; ">,</span> a <span style="color:#00dddd; ">%</span> b</span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> a</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> generate_cycle_lengths<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">,</span> m<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># returns a list of lists containing all combinations of cycle lengths</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># in descending order that add to n without exceeding m.</span></span>
<span class="line_wrapper">        h <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">min</span><span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">,</span> m<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">if</span> h <span style="color:#00dddd; ">&lt;=</span> <span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        combinations <span style="color:#d2cd86; ">=</span> <span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">]</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> l <span style="color:#e66170; font-weight:bold; ">in</span> <span style="color:#e66170; font-weight:bold; ">range</span><span style="color:#d2cd86; ">(</span>h<span style="color:#d2cd86; ">,</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">,</span><span style="color:#00dddd; ">-</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            <span style="color:#e66170; font-weight:bold; ">for</span> c <span style="color:#e66170; font-weight:bold; ">in</span> generate_cycle_lengths<span style="color:#d2cd86; ">(</span>n<span style="color:#00dddd; ">-</span>l<span style="color:#d2cd86; ">,</span> l<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">                combinations<span style="color:#d2cd86; ">.</span>append<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">[</span>l<span style="color:#d2cd86; ">]</span> <span style="color:#00dddd; ">+</span> c<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> combinations</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">def</span> num_perms<span style="color:#d2cd86; ">(</span>cycle_counter<span style="color:#d2cd86; ">,</span> n<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        <span style="color:#9999a9; "># Number of permutations that contain the cycles in cycle_counter</span></span>
<span class="line_wrapper">        num <span style="color:#d2cd86; ">=</span> factorial<span style="color:#d2cd86; ">(</span>n<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> length<span style="color:#d2cd86; ">,</span> ammount <span style="color:#e66170; font-weight:bold; ">in</span> cycle_counter<span style="color:#d2cd86; ">.</span>items<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            num <span style="color:#d2cd86; ">=</span> num<span style="color:#00dddd; ">//</span><span style="color:#d2cd86; ">(</span>length<span style="color:#00dddd; ">**</span>ammount<span style="color:#00dddd; ">*</span>factorial<span style="color:#d2cd86; ">(</span>ammount<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">return</span> num</span>
<span class="line_wrapper">    </span>
<span class="line_wrapper">    config <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">0</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">for</span> w_combs <span style="color:#e66170; font-weight:bold; ">in</span> generate_cycle_lengths<span style="color:#d2cd86; ">(</span>w<span style="color:#d2cd86; ">,</span>w<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">        w_num <span style="color:#d2cd86; ">=</span> num_perms<span style="color:#d2cd86; ">(</span>Counter<span style="color:#d2cd86; ">(</span>w_combs<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> w<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">        <span style="color:#e66170; font-weight:bold; ">for</span> h_combs <span style="color:#e66170; font-weight:bold; ">in</span> generate_cycle_lengths<span style="color:#d2cd86; ">(</span>h<span style="color:#d2cd86; ">,</span>h<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">:</span></span>
<span class="line_wrapper">            h_num <span style="color:#d2cd86; ">=</span> num_perms<span style="color:#d2cd86; ">(</span>Counter<span style="color:#d2cd86; ">(</span>h_combs<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span> h<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            num_cycles <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">sum</span><span style="color:#d2cd86; ">(</span><span style="color:#e66170; font-weight:bold; ">sum</span><span style="color:#d2cd86; ">(</span>gcd<span style="color:#d2cd86; ">(</span>a<span style="color:#d2cd86; ">,</span>b<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> a <span style="color:#e66170; font-weight:bold; ">in</span> h_combs<span style="color:#d2cd86; ">)</span> <span style="color:#e66170; font-weight:bold; ">for</span> b <span style="color:#e66170; font-weight:bold; ">in</span> w_combs<span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">            config <span style="color:#00dddd; ">+</span><span style="color:#d2cd86; ">=</span> w_num<span style="color:#00dddd; ">*</span>h_num<span style="color:#00dddd; ">*</span>s<span style="color:#00dddd; ">**</span>num_cycles</span>
<span class="line_wrapper">    config <span style="color:#d2cd86; ">=</span> config<span style="color:#00dddd; ">//</span><span style="color:#d2cd86; ">(</span>factorial<span style="color:#d2cd86; ">(</span>w<span style="color:#d2cd86; ">)</span><span style="color:#00dddd; ">*</span>factorial<span style="color:#d2cd86; ">(</span>h<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span></span>
<span class="line_wrapper">    <span style="color:#e66170; font-weight:bold; ">return</span> <span style="color:#e66170; font-weight:bold; ">str</span><span style="color:#d2cd86; ">(</span>config<span style="color:#d2cd86; ">)</span></span></pre>
          </section>
        </section>
      </article>
    </main>
    <footer>
      <script src="/scripts/foobar.js"></script>
    </footer>
  </body>
</html>
